# Save nämnare to gr0, täljare to gr1 and return addr to gr2 before running. Result will be in gr2


# GR usage
# GR0 nämnare
# GR1 divisiontäljare
# GR2 Result

# Setup
# GR0 and GR1 already as intended
divide:store 2,&divisionreturnaddr

# Improve precicion
load$ 2,0 # How many shifts
while 0<$1073741824
	lsl$ 0,1
	add$ 2,1
end while
store 2,&divisionshifted


load$ 2,0
store 1,&divisiontäljare
while 0>$0
	sub 0,&divisiontäljare
    add$ 2,65536
end while
sub$ 2,65536
lsr 2,&divisionshifted

jmp 0,&divisionreturnaddr



divisiontäljare: sli 0
divisionshifted: sli 0
divisionreturnaddr: sli 0

